(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     54095,       1806]
NotebookOptionsPosition[     45629,       1518]
NotebookOutlinePosition[     48070,       1580]
CellTagsIndexPosition[     48027,       1577]
WindowTitle->A simple example: a massless scalar in AdS_5 - Wolfram Mathematica
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["Q N MSPECTRAL TUTORIAL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"Related Tutorials \[RightGuillemet]\"\>",
        StripOnInput->False], {"\<\"Introduction\"\>":>
       Documentation`HelpLookup[
       "paclet:QNMspectral/tutorial/Introduction"], "\<\"Extensions\"\>":>
       Documentation`HelpLookup[
       "paclet:QNMspectral/tutorial/Extensions"], "\<\"Method\"\>":>
       Documentation`HelpLookup["paclet:QNMspectral/tutorial/Method"]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"Functions \[RightGuillemet]\"\>",
        StripOnInput->False], {"\<\"GetAccurateModes\"\>":>
       Documentation`HelpLookup[
       "paclet:QNMspectral/ref/GetAccurateModes"], "\<\"GetModes\"\>":>
       Documentation`HelpLookup[
       "paclet:QNMspectral/ref/GetModes"], "\<\"MakeTable\"\>":>
       Documentation`HelpLookup[
       "paclet:QNMspectral/ref/MakeTable"], "\<\"PlotFrequencies\"\>":>
       Documentation`HelpLookup[
       "paclet:QNMspectral/ref/PlotFrequencies"], "\<\"ShowModes\"\>":>
       Documentation`HelpLookup["paclet:QNMspectral/ref/ShowModes"]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"URL \[RightGuillemet]\"\>",
        StripOnInput->False], {"\<\"QNMspectral/tutorial/SimpleExample\"\>":>
       None, "\<\"Copy Mathematica url\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["QNMspectral/tutorial/SimpleExample"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web url\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/mathematica/QNMspectral/\
tutorial/SimpleExample.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web url\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
            "http://reference.wolfram.com/mathematica/", 
             "QNMspectral/tutorial/SimpleExample", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 "A simple example: a massless scalar in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["AdS", "5"], TraditionalForm]], "InlineMath"]
}], "Title",
 CellID->31199131],

Cell[TextData[{
 "A technically simple example of a quasinormal mode that can only be \
computed numerically is that of a massless scalar field in an ",
 Cell[BoxData[
  SubscriptBox["AdS", "5"]], "InlineFormula"],
 " background."
}], "Text",
 CellID->1787845352],

Cell["\<\
We will illustrate the workings of this package by computing these modes.\
\>", "Text",
 CellID->1556227079],

Cell[CellGroupData[{

Cell["This loads the package:", "MathCaption",
 CellID->1825449234],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QNMspectral`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1373894796]
}, Open  ]],

Cell[CellGroupData[{

Cell["The quasinormal mode equation", "Subsection",
 CellID->937227206],

Cell[TextData[{
 "The action of a massless scalar field is given ",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], 
     RowBox[{"\[Integral]", 
      RowBox[{
       SuperscriptBox["d", "5"], "x", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Mu]"], "\[Phi]"}], 
       RowBox[{
        SuperscriptBox["\[PartialD]", "\[Mu]"], "\[Phi]"}]}]}]}]}], 
   TraditionalForm]], "InlineMath"],
 ". "
}], "Text",
 Deletable->True,
 CellID->835551855],

Cell["\<\
The method used for the numerical computation requires that the equation is \
written in Eddington-Finkelstein coordinates. The reason is that in these \
coordinates the condition that the perturbation be infalling at the horizon \
becomes merely the condition that the perturbation be regular at the horizon. \
\>", "Text",
 CellID->1290761750],

Cell["\<\
This allows us to impose the boundary condition there only implicitly, \
through expressing the perturbation as a sum of finite functions. For more on \
this see the section technical details below.\
\>", "Text",
 CellID->328755023],

Cell[TextData[{
 "So we take the metric to be (we set the horizon at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "=", "1"}], TraditionalForm]], "InlineMath"],
 ", this is the default assumed value, but can be changed by setting ",
 Cell[BoxData["Horizon"], "InlineFormula"],
 ")"
}], "Text",
 Deletable->True,
 CellID->2025035829],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["ds", "2"], "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", " ", 
       RowBox[{"f", "(", "r", ")"}]}], " ", 
      SuperscriptBox["dt", "2"]}], "+", 
     RowBox[{"2", " ", "dt", " ", "dr"}], " ", "+", " ", 
     RowBox[{
      SuperscriptBox["r", "2"], 
      SuperscriptBox[
       StyleBox[
        RowBox[{"d", 
         StyleBox["x",
          FontWeight->"Bold"]}]], "2"]}]}]}], TraditionalForm]], "InlineMath"],
 ", with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "r", ")"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox["r", "2"], "(", 
     RowBox[{"1", "-", 
      SuperscriptBox["r", 
       RowBox[{"-", "4"}]]}], ")"}]}], TraditionalForm]], "InlineMath"],
 "."
}], "Text",
 Deletable->True,
 CellID->1841087170],

Cell[TextData[{
 "In these coordinates the boundary is at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "\[RightArrow]", "\[Infinity]"}], TraditionalForm]], 
  "InlineMath"],
 ". This is ofcourse inconvenient for the numerics, so we first transform to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{"1", "/", "r"}]}], TraditionalForm]], "InlineMath"],
 ", to get "
}], "Text",
 Deletable->True,
 CellID->1765745690],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["ds", "2"], "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", " ", 
       RowBox[{"f", "(", "u", ")"}]}], " ", 
      SuperscriptBox["dt", "2"]}], "-", 
     RowBox[{
      FractionBox["2", 
       SuperscriptBox["u", "2"]], " ", "dt", " ", "du"}], " ", "+", " ", 
     RowBox[{
      SuperscriptBox["u", 
       RowBox[{"-", "2"}]], 
      SuperscriptBox[
       StyleBox[
        RowBox[{"d", 
         StyleBox["x",
          FontWeight->"Bold"]}]], "2"]}]}]}], TraditionalForm]], "InlineMath"],
 ", with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "u", ")"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox["u", 
      RowBox[{"-", "2"}]], "(", 
     RowBox[{"1", "-", 
      SuperscriptBox["u", "4"]}], ")"}]}], TraditionalForm]], "InlineMath"],
 "."
}], "Text",
 Deletable->True,
 CellID->304380513],

Cell["\<\
Now we take a quasinormal mode ansatz for \[Phi]:\
\>", "Text",
 CellID->429781387],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"\[Phi]", "(", 
    RowBox[{"u", ",", "t", ",", "y"}], ")"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"0", " ", "+", " ", 
     RowBox[{"\[Delta]\[Phi]", "(", 
      RowBox[{"u", ",", "t", ",", "y"}], ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"\[Delta]\[Phi]", "(", "u", ")"}], " ", 
     SuperscriptBox["e", 
      RowBox[{"-", 
       RowBox[{"i", "(", 
        RowBox[{
         RowBox[{"\[Omega]", " ", "t"}], " ", "-", " ", "ky"}], 
        ")"}]}]]}]}]}], TraditionalForm]], "InlineMath"]], "Text",
 Deletable->True,
 CellID->507870360],

Cell["The equation of motion is", "Text",
 CellID->1797864630],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Mu]"], 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{"-", "g"}]], 
       SuperscriptBox["g", "\[Mu]\[Nu]"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Nu]"], "\[Phi]"}]}], ")"}]}], "=", 
    "0"}], TraditionalForm]], "InlineMath"],
 ","
}], "Text",
 Deletable->True,
 CellID->1741677878],

Cell[CellGroupData[{

Cell[TextData[{
 "which we can enter in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " as"
}], "Text",
 CellID->1060434079],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gdd", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"f", "[", "u", "]"}]}], ",", 
       RowBox[{"-", 
        FractionBox["1", 
         SuperscriptBox["u", "2"]]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         SuperscriptBox["u", "2"]]}], ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       FractionBox["1", 
        SuperscriptBox["u", "2"]], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       FractionBox["1", 
        SuperscriptBox["u", "2"]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       FractionBox["1", 
        SuperscriptBox["u", "2"]]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gUU", "=", 
   RowBox[{"Inverse", "[", "gdd", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Det", "[", "gdd", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"coords", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "u", ",", "x", ",", "y", ",", "z"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Omega]", "=", 
   RowBox[{"2", "\[Pi]", " ", "T", " ", "\[Lambda]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"2", "\[Pi]", " ", "T", " ", "q"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[PartialD]", "r"], 
        FractionBox["1", "r"]}], ")"}], 
      FractionBox[
       RowBox[{
        RowBox[{"f", "'"}], "[", "1", "]"}], 
       RowBox[{"4", "\[Pi]"}]]}], "/.", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"1", "/", "u"}]}]}], "/.", 
    RowBox[{"u", "\[Rule]", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"t_", ",", "u_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Delta]\[Phi]", "[", "u", "]"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", " ", "t"}], "-", 
        RowBox[{"k", " ", "y"}]}], ")"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"eq\[Phi]f0", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"\[Mu]", "=", "1"}], "5"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[Nu]", "=", "1"}], "5"], 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{
       "coords", "\[LeftDoubleBracket]", "\[Mu]", "\[RightDoubleBracket]"}]], 
      
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"-", "g"}]], " ", 
        RowBox[{"gUU", "\[LeftDoubleBracket]", 
         RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{
          "coords", "\[LeftDoubleBracket]", "\[Nu]", 
           "\[RightDoubleBracket]"}]], 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"t", ",", "u", ",", "y"}], "]"}]}]}], ")"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eq\[Phi]f", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", " ", "t"}], "-", 
        RowBox[{"k", " ", "y"}]}], ")"}]}], "]"}], 
    RowBox[{"PowerExpand", "[", "eq\[Phi]f0", "]"}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"_", "[", "u", "]"}], ",", "Simplify"}], "]"}], 
    "&"}]}]}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1514484602],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"\[Delta]\[Phi]", "[", "u", "]"}], " ", 
     RowBox[{
      SuperscriptBox["f", "\[Prime]",
       MultilineFunction->None], "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "6"}], " ", "\[ImaginaryI]", " ", "\[Lambda]"}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", "u", " ", 
        RowBox[{
         SuperscriptBox["f", "\[Prime]",
          MultilineFunction->None], "[", "1", "]"}]}]}], ")"}]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["u", "4"]}]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[Lambda]", " ", 
        RowBox[{
         SuperscriptBox["f", "\[Prime]",
          MultilineFunction->None], "[", "1", "]"}]}], 
       SuperscriptBox["u", "3"]]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["f", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}], "u"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Delta]\[Phi]", "\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}], "+", 
  RowBox[{
   RowBox[{"f", "[", "u", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Delta]\[Phi]", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}], 
       SuperscriptBox["u", "2"]]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Delta]\[Phi]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "u", "]"}], "u"]}], 
    ")"}]}]}]], "Output",
 ImageSize->{562, 37},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[11]=",
 CellID->549042564]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "where we defined the dimensionless quantities ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Lambda]", "=", 
    FractionBox["\[Omega]", 
     RowBox[{"2", "\[Pi]", " ", "T"}]]}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"q", "=", 
    FractionBox["k", 
     RowBox[{"2", "\[Pi]", " ", "T"}]]}], TraditionalForm]], "InlineMath"],
 ", where ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]], "InlineMath"],
 " is the temperature."
}], "Text",
 Deletable->True,
 CellID->1303284516],

Cell[CellGroupData[{

Cell["We plug in the blackening function f:", "Text",
 CellID->1493324862],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fsol", "[", "u_", "]"}], ":=", 
  RowBox[{
   SuperscriptBox["u", 
    RowBox[{"-", "2"}]], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["u", "4"]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq\[Phi]0", "=", 
  RowBox[{
   RowBox[{"eq\[Phi]f", "/.", 
    RowBox[{"f", "\[Rule]", "fsol"}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"f_", "[", "u", "]"}], ",", "Simplify"}], "]"}], 
    "&"}]}]}]}], "Input",
 InitializationCell->False,
 CellLabel->"In[12]:=",
 CellID->165628634],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["q", "2"], " ", "u"}], "+", 
       RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Lambda]"}]}], ")"}], " ", 
     RowBox[{"\[Delta]\[Phi]", "[", "u", "]"}]}], 
    SuperscriptBox["u", "4"]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3", "+", 
      SuperscriptBox["u", "4"], "-", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "u", " ", "\[Lambda]"}]}], 
     ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[Delta]\[Phi]", "\[Prime]",
      MultilineFunction->None], "[", "u", "]"}]}], 
   SuperscriptBox["u", "4"]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["u", "3"]], "-", "u"}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Delta]\[Phi]", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}]}]], "Output",
 ImageSize->{408, 37},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[13]=",
 CellID->998607368]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "As mentioned before, in these coordinates the infalling boundary condition \
at the horizon becomes merely regularity. We still have to worry about the \
boundary condition at the boundary though. A massless scalar in ",
 Cell[BoxData[
  SubscriptBox["AdS", "5"]], "InlineFormula"],
 " has the boundary behaviours:"
}], "Text",
 CellID->1253768039],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"\[Delta]\[Phi]", "(", "u", ")"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"j", "  ", "+"}], " ", "..."}], ")"}], " ", "+", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"v", " ", 
        SuperscriptBox["u", "4"]}], "+"}], "..."}], ")"}]}]}], 
  TraditionalForm]], "InlineMath"]], "Text",
 Deletable->True,
 CellID->1014163764],

Cell[CellGroupData[{

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]], "InlineMath"],
 " is the non-normalizable mode and ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]], "InlineMath"],
 " the normalizable mode, with dots indicating corrections to higher order in \
",
 Cell[BoxData[
  FormBox["u", TraditionalForm]], "InlineMath"],
 ". We can also see this in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ":"
}], "Text",
 Deletable->True,
 CellID->937825228],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["u", 
       RowBox[{"-", "p"}]], "eq\[Phi]0"}], "/.", 
     RowBox[{"\[Delta]\[Phi]", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "^", "p"}], "&"}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"u", ",", "0", ",", 
      RowBox[{"-", "5"}]}], "}"}]}], "]"}], "//", 
  "Normal"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "p"}], "]"}]}], "Input",
 InitializationCell->False,
 CellLabel->"In[14]:=",
 CellID->77585105],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "4"}], " ", "p"}], "+", 
   SuperscriptBox["p", "2"]}], 
  SuperscriptBox["u", "5"]]], "Output",
 ImageSize->{60, 35},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[14]=",
 CellID->880873844],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "4"}], "}"}]}], "}"}]], "Output",
 ImageSize->{119, 14},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[15]=",
 CellID->94433690]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "We want the boundary condition at the boundary to also become finiteness, \
so we have to rescale ",
 Cell[BoxData[
  FormBox["\[Delta]\[Phi]", TraditionalForm]], "InlineMath"],
 " such that the non-normalizable term, instead of going to a constant, \
diverges, while the normalizable term remains finite. "
}], "Text",
 Deletable->True,
 CellID->560623119],

Cell[TextData[{
 "There are multiple ways to do this, but it appears most accurate to let the \
normalizable term go to 0 linearly in ",
 Cell[BoxData[
  FormBox["u", TraditionalForm]], "InlineMath"],
 "."
}], "Text",
 Deletable->True,
 CellID->152469139],

Cell[CellGroupData[{

Cell["\<\
Finally we have to make sure the equation itself goes to a nontrivial \
constant at the boundary. We do these last two steps below:\
\>", "Text",
 CellID->2095175303],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq\[Phi]", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["u", 
      RowBox[{"2", " "}]], "eq\[Phi]0"}], "/.", 
    RowBox[{"\[Delta]\[Phi]", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["#", "3"], 
        RowBox[{"\[Delta]\[Phi]fin", "[", "#", "]"}]}], "&"}], ")"}]}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"f_", "[", "u", "]"}], ",", "Simplify"}], "]"}], 
    "&"}]}]}]], "Input",
 InitializationCell->False,
 CellLabel->"In[16]:=",
 CellID->775987710],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["q", "2"], " ", 
      SuperscriptBox["u", "2"]}], "-", 
     RowBox[{"9", " ", 
      SuperscriptBox["u", "4"]}], "+", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "u", " ", "\[Lambda]"}]}], ")"}],
    " ", 
   RowBox[{"\[Delta]\[Phi]fin", "[", "u", "]"}]}], "+", 
  RowBox[{"u", " ", 
   RowBox[{"(", 
    RowBox[{"3", "-", 
     RowBox[{"7", " ", 
      SuperscriptBox["u", "4"]}], "+", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "u", " ", "\[Lambda]"}]}], ")"}],
    " ", 
   RowBox[{
    SuperscriptBox["\[Delta]\[Phi]fin", "\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["u", "2"], "-", 
     SuperscriptBox["u", "6"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Delta]\[Phi]fin", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}]}]], "Output",
 ImageSize->{559, 18},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[16]=",
 CellID->1522130904]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
A final check that the equation goes to a nontrivial constant and the \
non-normalizable mode diverges while the normalizable one does not:\
\>", "Text",
 CellID->1813055722],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Series", "[", 
  RowBox[{"eq\[Phi]", ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", "0", ",", "0"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["u", 
        RowBox[{"-", "p"}]], "eq\[Phi]"}], "/.", 
      RowBox[{"\[Delta]\[Phi]fin", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "^", "p"}], "&"}], ")"}]}]}], "//", "Expand"}], ",", 
    RowBox[{"{", 
     RowBox[{"u", ",", "0", ",", "0"}], "}"}]}], "]"}], "//", 
  "Normal"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "p"}], "]"}]}], "Input",
 InitializationCell->False,
 CellLabel->"In[17]:=",
 CellID->697829433],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"3", " ", 
     RowBox[{"\[Delta]\[Phi]fin", "[", "0", "]"}]}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "u", "]"}], "1"],
    SeriesData[$CellContext`u, 0, {}, 0, 1, 1],
    Editable->False]}],
  SeriesData[$CellContext`u, 0, {(-3) $CellContext`\[Delta]\[Phi]fin[0]}, 0, 
   1, 1],
  Editable->False]], "Output",
 ImageSize->{126, 16},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[17]=",
 CellID->808566492],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "3"}], "+", 
  RowBox[{"2", " ", "p"}], "+", 
  SuperscriptBox["p", "2"]}]], "Output",
 ImageSize->{75, 16},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[18]=",
 CellID->300512828],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", "\[Rule]", "1"}], "}"}]}], "}"}]], "Output",
 ImageSize->{127, 14},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[19]=",
 CellID->1985046099]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical solution", "Subsection",
 CellID->581645126],

Cell["\<\
Having brought the equation in the right form, we are now able to do the \
numerical computation. Note that the package always assumes that this has \
been done already.\
\>", "Text",
 CellID->1011084164],

Cell[TextData[{
 "The computation then can be done with the function ",
 Cell[BoxData[
  StyleBox[
   ButtonBox[
    StyleBox["GetModes",
     FontSlant->"Plain"],
    BaseStyle->"Link",
    ButtonData->"paclet:QNMspectral/ref/"],
   FontSlant->"Plain"]], "InlineFormula",
  FontSlant->"Italic"],
 ":"
}], "Text",
 CellID->1010120377],

Cell[BoxData[GridBox[{
   {
    RowBox[{
     ButtonBox["GetModes",
      BaseStyle->"Link",
      ButtonData->"paclet:QNMspectral/ref/GetModes"], "[", 
     RowBox[{
      StyleBox["eq",
       FontSlant->"Italic"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["N",
         FontSlant->"Italic"], ",", 
        StyleBox["prec",
         FontSlant->"Italic"]}], "}"}]}], "]"}], Cell[TextData[{
     "discretize the equation ",
     StyleBox["eq",
      FontSlant->"Italic"],
     " on a spectral grid of ",
     StyleBox["N+1 ",
      FontSlant->"Italic"],
     "points with ",
     StyleBox["prec",
      FontSlant->"Italic"],
     " digits of precision, and compute the quasinormal modes"
    }], "TableText"]}
  }]], "DefinitionBox",
 CellID->1578453305],

Cell[CellGroupData[{

Cell["So now it is done in one line:", "Text",
 CellID->729592064],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"modes", "=", 
    RowBox[{"GetModes", "[", 
     RowBox[{
      RowBox[{"eq\[Phi]", "/.", 
       RowBox[{"q", "\[Rule]", "1"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"40", ",", "0"}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellLabel->"In[20]:=",
 CellID->1694197072],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00810300000000000082700513104327910696`3.929245752186737", ",", "Null"}],
   "}"}]], "Output",
 ImageSize->{116, 13},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[20]=",
 CellID->387574357]
}, Open  ]]
}, Open  ]],

Cell["\<\
Notice the precision 0, in this case it will use machine precision, which is \
16 digits. \
\>", "Text",
 CellID->344331292],

Cell["\<\
Also note that we did not have to make an equation using == 0, we could, but \
if we don't then this is assumed. We also do not have to specify what the \
fluctuation, the radial variable, or the frequency are called, this is done \
automatically.\
\>", "Text",
 CellID->1376479922]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displaying results", "Subsection",
 CellID->1658998297],

Cell["To visualize the results, there are three functions:", "Text",
 CellID->2011042926],

Cell[BoxData[GridBox[{
   {
    RowBox[{
     ButtonBox["PlotFrequencies",
      BaseStyle->"Link",
      ButtonData->"paclet:QNMspectral/ref/PlotFrequencies"], "[", 
     StyleBox["modes",
      FontSlant->"Italic"], "]"}], Cell[
    "make a plot of the QNM frequencies in the complex plane", "TableText"]},
   {
    RowBox[{
     ButtonBox["MakeTable",
      BaseStyle->"Link",
      ButtonData->"paclet:QNMspectral/ref/MakeTable"], "[", 
     StyleBox["modes",
      FontSlant->"Italic"], "]"}], Cell[
    "make a table of the modes", "TableText"]},
   {
    RowBox[{
     ButtonBox["ShowModes",
      BaseStyle->"Link",
      ButtonData->"paclet:QNMspectral/ref/ShowModes"], "[", 
     StyleBox["modes",
      FontSlant->"Italic"], "]"}], Cell[
    "show the plot and the table side by side", "TableText"]}
  }]], "DefinitionBox",
 CellID->4950932],

Cell[CellGroupData[{

Cell["which we can use as:", "Text",
 CellID->295912815],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PlotFrequencies", "[", "modes", "]"}]], "Input",
 CellLabel->"In[21]:=",
 CellID->1137110983],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0, 0, 1], PointSize[Large], PointBox[CompressedData["
1:eJwdx30wE3AcgPHd8pa3zGw2zLXYvO2auhBO+11sSrIau5tuHRY65dIpUl1e
zlwOHW7uyJzsXDfc6Sx5vdgXi52SKdZhXXdypcjbZtYptfnjuec+VFEOLwOL
wWD8zVleIdzN24z5pyzrXdSbOAalQW60mNXO1h249Hg0ecLeFnq/qOLDRFjg
TO97mo26Zru4Fss+hjOlrGBoO88pdqdZA+NBiMXIqvvigQ8tXybkKpzRWY8n
Yatie5gbof7KUjhDMDf26rrZwx8aa43lDKi4ixd3zjhAwnhatdkoMXX9wEXj
Aa+WuAGgXdGEJfFdQL05m282OndFU2Dxtb+HtxIj8agqNoJniMPBwx7VEDYC
D2XynIIbCThYzvB6fLuQDlYK6zOI7QraaQHhViEdlbDJ2jiziXWOojG9D5RM
MCbtlvBQndJYt6r3Qc4uNKPS7Pczo9zkDSJ6XXzzeWy3G7xszXZjNlFhZYjx
Yj+KAPhZwfiAjIrw4kcSNYsALJt04e8aIvQERbb2SQiQvkYa7JB4oHryJZpy
gQBMQxYlz+iNNoRR3+u9iRAY2Fy+tkgC3r3KYKeTREDrkw3Lld6gH/yEUdwh
grQU+9bEdkUX+AuO0yZ3yA0dsU/b8YKintp44jAJhpyOaJeKcJD9s6qtSeYB
bf6Bkq/IBhXMN2/LT3tCaD2rnx1BQb1icnZmvifYpMx9jipdZXEc2It7dAps
h3czdam20LqSIL+fTAFZy4lJ/dSWkp6pzvqhpsAzr5qn86Nk6PRL2tSRqCBc
2BOFSMnIUaW7nkI5BhtGRn/0lCvwVEfZfVJf4EQWMwW7OMR/I3A5JaLBjB2/
o6Xjj9I3Rjo2oKHDzjeqpr3SxHoXlMlI9fWD/6ugNs8=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  BaseStyle->{FontSize -> 30},
  Frame->True,
  FrameLabel->{{
     FormBox["\"Im \[Omega]\"", TraditionalForm], None}, {
     FormBox["\"Re \[Omega]\"", TraditionalForm], None}},
  ImageSize->600,
  LabelStyle->{FontSize -> 30},
  Method->{},
  PlotRange->{{-16.248461677186814`, 
    16.24846167617413}, {-11.571046245071464`, 0}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.6499384670672188, 0.6499384670672188}, {
   0.2314209249014293, 0.2314209249014293}}]], "Output",
 ImageSize->{604, 394},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[21]=",
 CellID->1419035462]
}, Open  ]]
}, Open  ]],

Cell["\<\
This plot shows 41 points, because what GetModes does is calculate the \
eigenvalues of an N+1 by N+1 matrix, of which there are ofcourse 41. But not \
all are accurate, as the discretization of the equation isn't completely \
accurate. In practice, only the first few modes will be accurate, depending \
on the grid size and precision used.\
\>", "Text",
 CellID->1975071336],

Cell[CellGroupData[{

Cell["Knowing this, we can just look at the first few modes:", "Text",
 CellID->766681643],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShowModes", "[", 
  RowBox[{"modes", ",", 
   RowBox[{"NModes", "\[Rule]", "4"}]}], "]"}]], "Input",
 CellLabel->"In[23]:=",
 CellID->1694873568],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{{}, 
     {RGBColor[0, 0, 1], PointSize[Large], 
      PointBox[{{-1.9543308837944857`, -1.2673272634232557`}, {
       1.9543308837842206`, -1.2673272634313923`}, {-2.880262563097689, \
-2.297957038648714}, {2.880262583459543, -2.2979570604171258`}}]}, {}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    AxesOrigin->{0, 0},
    BaseStyle->{FontSize -> 30},
    Frame->True,
    FrameLabel->{{
       FormBox["\"Im \[Omega]\"", TraditionalForm], None}, {
       FormBox["\"Re \[Omega]\"", TraditionalForm], None}},
    ImageSize->600,
    LabelStyle->{FontSize -> 30},
    Method->{},
    PlotRange->{{-2.880262563097689, 
      2.880262583459543}, {-2.2979570604171258`, 0}},
    PlotRangeClipping->True,
    PlotRangePadding->{{0.11521050293114464`, 0.11521050293114464`}, {
     0.04595914120834252, 0.04595914120834252}}], ",", 
   TagBox[GridBox[{
      {"\<\"n\"\>", "\<\"Re \\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(n\\)]\\)\
\"\>", "\<\"Im \\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(n\\)]\\)\"\>"},
      {"1", "\<\"\[PlusMinus] \
\\!\\(TraditionalForm\\`1.9543308837944857`\\)\"\>", 
       RowBox[{"-", "1.2673272634232557`"}]},
      {"2", "\<\"\[PlusMinus] \\!\\(TraditionalForm\\`2.880262563097689`\\)\"\
\>", 
       RowBox[{"-", "2.297957038648714`"}]}
     },
     AutoDelete->False,
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}], "}"}]], "Output",
 ImageSize->{790, 387},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[23]=",
 CellID->196057643]
}, Open  ]]
}, Open  ]],

Cell["\<\
Notice however that now only the first 4 modes shown are correct (in this \
case the modes lie almost on a straight line), even though from the previous \
plot we saw that the first 10 modes are roughly correct. They are sorted by \
imaginary part, and here inaccurate modes with higher imaginary part than the \
next accurate one occur, so this solution is not ideal.\
\>", "Text",
 CellID->730031461]
}, Open  ]],

Cell[CellGroupData[{

Cell["A more accurate solution", "Subsection",
 CellID->1118107951],

Cell[CellGroupData[{

Cell["\<\
If we want more accurate modes, we can simply increase the gridsize and \
precision. Beware that for large grid sizes the precision may become the \
bottleneck. Ofcourse increasing either the gridsize or the precision will \
slow down the computation, but this should still take less than a minute:\
\>", "Text",
 CellID->1258997364],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"modes2", "=", 
    RowBox[{"GetModes", "[", 
     RowBox[{
      RowBox[{"eq\[Phi]", "/.", 
       RowBox[{"q", "\[Rule]", "1"}]}], ",", 
      RowBox[{"{", "100", "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"ShowModes", "[", 
  RowBox[{"modes2", ",", 
   RowBox[{"NModes", "\[Rule]", "10"}]}], "]"}]}], "Input",
 CellLabel->"In[24]:=",
 CellID->1803307368],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "33.01579399999999964165908750146627426147`7.5393216594039405", ",", 
   "Null"}], "}"}]], "Output",
 ImageSize->{123, 13},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[24]=",
 CellID->1775003733],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{{}, 
     {RGBColor[0, 0, 1], PointSize[Large], 
      PointBox[{{-1.9543308837904205`, -1.267327263417064}, {
       1.9543308837904205`, -1.267327263417064}, {
       2.880262564849642, -2.297957046519873}, {-2.880262564849642, \
-2.297957046519873}, {-3.836632222933903, -3.314907160289994}, {
       3.836632222933903, -3.314907160289994}, {-4.807392343053173, \
-4.325871369550775}, {4.807392343053173, -4.325871369550775}, {
       5.7861818767378095`, -5.333622203939407}, {-5.7861818767378095`, \
-5.333622203939407}}]}, {}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    AxesOrigin->{0, 0},
    BaseStyle->{FontSize -> 30},
    Frame->True,
    FrameLabel->{{
       FormBox["\"Im \[Omega]\"", TraditionalForm], None}, {
       FormBox["\"Re \[Omega]\"", TraditionalForm], None}},
    ImageSize->600,
    LabelStyle->{FontSize -> 30},
    Method->{},
    PlotRange->{{-5.7861818767378095`, 
      5.7861818767378095`}, {-5.333622203939407, 0}},
    PlotRangeClipping->True,
    PlotRangePadding->{{0.23144727506951238`, 0.23144727506951238`}, {
     0.10667244407878813`, 0.10667244407878813`}}], ",", 
   TagBox[GridBox[{
      {"\<\"n\"\>", "\<\"Re \\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(n\\)]\\)\
\"\>", "\<\"Im \\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(n\\)]\\)\"\>"},
      {"1", "\<\"\[PlusMinus] \
\\!\\(TraditionalForm\\`1.95433088379042054659643156009409403783`10.\\)\"\>", 
       
       RowBox[{"-", "1.2673272634170641028504087400441669664`10."}]},
      {"2", "\<\"\[PlusMinus] \
\\!\\(TraditionalForm\\`2.880262564849641861888009705568912646`10.\\)\"\>", 
       RowBox[{"-", "2.29795704651987325803990291900536177692`10."}]},
      {"3", "\<\"\[PlusMinus] \
\\!\\(TraditionalForm\\`3.83663222293390334206171644621827678611`10.\\)\"\>", 
       
       RowBox[{"-", "3.31490716028999405304954562979692488023`10."}]},
      {"4", "\<\"\[PlusMinus] \
\\!\\(TraditionalForm\\`4.80739234305317243661774609304490095781`10.\\)\"\>", 
       
       RowBox[{"-", "4.325871369550775288657828661431576053`10."}]},
      {"5", "\<\"\[PlusMinus] \
\\!\\(TraditionalForm\\`5.78618187673780904408641518636933697305`10.\\)\"\>", 
       
       RowBox[{"-", "5.33362220393940700128747514146303966629`10."}]}
     },
     AutoDelete->False,
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}], "}"}]], "Output",
 ImageSize->{848, 401},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[25]=",
 CellID->1792400054]
}, Open  ]]
}, Open  ]],

Cell["\<\
Here we didn't specify the precision, so it defaults to half the grid size.\
\>", "Text",
 CellID->818447496]
}, Open  ]],

Cell[CellGroupData[{

Cell["Recommended use: GetAccurateModes", "Subsection",
 CellID->1211574677],

Cell["\<\
Since this large amount of incorrect modes is unavoidable using this method \
and the above solutions are tedious, there is a built in function to deal \
with this automatically:\
\>", "Text",
 CellID->1859462476],

Cell[BoxData[GridBox[{
   {
    RowBox[{
     ButtonBox["GetAccurateModes",
      BaseStyle->"Link",
      ButtonData->"paclet:QNMspectral/ref/GetAccurateModes"], "[", 
     RowBox[{
      StyleBox["eq",
       FontSlant->"Italic"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["N",
         FontSlant->"Italic"], ",", 
        StyleBox["prec",
         FontSlant->"Italic"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["N2",
         FontSlant->"Italic"], ",", 
        StyleBox["prec2",
         FontSlant->"Italic"]}], "}"}]}], "]"}], Cell["\<\
computes modes with two gridsizes and precisions, returning only the common \
values\
\>", "TableText"]}
  }]], "DefinitionBox",
 CellID->1964514107],

Cell[TextData[{
 "What this does is to compute the quasinormal mode spectrum using ",
 Cell[BoxData[
  ButtonBox["GetModes",
   BaseStyle->"Link",
   ButtonData->"paclet:QNMspectral/ref/GetModes"]], "InlineFormula"],
 ", with two sets of precision  ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"{", 
    RowBox[{"N", ",", "prec"}], "}"}],
   FontSlant->"Italic"]], "InlineFormula"],
 " and ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"{", 
    RowBox[{"N2", ",", "prec2"}], "}"}],
   FontSlant->"Italic"]], "InlineFormula"],
 ". Then it looks for modes in the first set which have a mode in the second \
set that is very close (with a difference less than ",
 Cell[BoxData[
  SuperscriptBox[
   StyleBox["10",
    FontSlant->"Italic"], 
   RowBox[{"-", "Cutoff"}]]], "InlineFormula"],
 ", where ",
 Cell[BoxData["Cutoff"], "InlineFormula"],
 " is an option defaulting to 1). Of these modes it then returns only those \
digits that agree between both sets."
}], "Text",
 CellID->1178234338],

Cell["\<\
Provided the precision and gridsizes are not chosen too close together, and \
the background is either analytic or accurate enough not to be the source of \
errors, this practically (though not actually!) guarantees that the modes \
that are returned have converged.\
\>", "Text",
 CellID->1500892470],

Cell[CellGroupData[{

Cell["It can be used as:", "Text",
 CellID->1611005974],

Cell[BoxData[
 RowBox[{
  RowBox[{"modesAccurate", "=", 
   RowBox[{"GetAccurateModes", "[", 
    RowBox[{
     RowBox[{"eq\[Phi]", "/.", 
      RowBox[{"q", "\[Rule]", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"40", ",", "0"}], "}"}], ",", 
     RowBox[{"{", "100", "}"}]}], "]"}]}], ";"}]], "Input",
 CellID->295815638]
}, Open  ]],

Cell[TextData[{
 "Note that this computation is done almost instantaneously, as we had \
previously computed the modes with exactly these settings. By default ",
 Cell[BoxData[
  ButtonBox["GetModes",
   BaseStyle->"Link",
   ButtonData->"paclet:QNMspectral/ref/GetModes"]], "InlineFormula"],
 " remembers everything it computes, this can be turned off by setting ",
 Cell[BoxData[
  RowBox[{"$QNMMemory", "=", "False"}]], "InlineFormula"],
 "."
}], "Text",
 CellID->292143153],

Cell[CellGroupData[{

Cell["\<\
Since we automatically got rid of all the inaccurate modes, we can now simply \
display all of them:\
\>", "Text",
 CellID->425918072],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"modesAccurate", "//", "ShowModes"}]], "Input",
 CellID->348785061],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{{}, {{}, 
      {RGBColor[0, 0, 1], PointSize[Large], AbsoluteThickness[1.6], 
       StyleBox[
        PointBox[{{-1.9543308837904205`, -1.267327263417064}, {
         1.9543308837904205`, -1.267327263417064}, {-2.880262564849642, \
-2.297957046519873}, {
         2.880262564849642, -2.297957046519873}, {-3.836632222933903, \
-3.314907160289994}, {
         3.836632222933903, -3.314907160289994}, {-4.807392343053173, \
-4.325871369550775}, {4.807392343053173, -4.325871369550775}}],
        FontSize->30]}, {}}, {}, {}, {{}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{0., 0.},
    BaseStyle->{FontSize -> 30},
    DisplayFunction->Identity,
    Frame->{{True, True}, {True, True}},
    FrameLabel->{{
       FormBox["\"Im \[Omega]\"", TraditionalForm], None}, {
       FormBox["\"Re \[Omega]\"", TraditionalForm], None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    ImagePadding->All,
    ImageSize->600,
    LabelStyle->{FontSize -> 30},
    Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
           Part[#, 1]], 
          (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
           Part[#, 2]]}& )}},
    PlotRange->{{-4.807392343053173, 4.807392343053173}, {-4.325871369550775, 
     0.}},
    PlotRangeClipping->True,
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.05], 
       Scaled[0.02]}},
    Ticks->{Automatic, Automatic}], ",", 
   TagBox[GridBox[{
      {"\<\"n\"\>", "\<\"Re \\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(n\\)]\\)\
\"\>", "\<\"Im \\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(n\\)]\\)\"\>"},
      {"1", "\<\"\[PlusMinus] \
\\!\\(\\*FormBox[\\\"1.95433088379042054659643156009409403783`10.\\\", \
TraditionalForm]\\)\"\>", 
       RowBox[{"-", "1.2673272634170641028504087400441669664`10."}]},
      {"2", "\<\"\[PlusMinus] \
\\!\\(\\*FormBox[\\\"2.8802625648496418619`8.043552861348699\\\", \
TraditionalForm]\\)\"\>", 
       RowBox[{"-", "2.297957046519873258`7.945462688065652"}]},
      {"3", "\<\"\[PlusMinus] \
\\!\\(\\*FormBox[\\\"3.8366322229339033421`6.029428012727959\\\", \
TraditionalForm]\\)\"\>", 
       RowBox[{"-", "3.3149071602899940531`5.965949212463375"}]},
      {"4", "\<\"\[PlusMinus] \
\\!\\(\\*FormBox[\\\"4.8073923430531724366`3.021710825702469\\\", \
TraditionalForm]\\)\"\>", 
       RowBox[{"-", "4.3258713695507752886`2.9758748597739744"}]},
      {"5", "\<\"\[PlusMinus] \
\\!\\(\\*FormBox[\\\"4.8073923430531724366`3.021710825702469\\\", \
TraditionalForm]\\)\"\>", 
       RowBox[{"-", "4.3258713695507752886`2.9758748597739744"}]}
     },
     AutoDelete->False,
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}], "}"}]], "Output",
 ImageSize->{848, 405},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellID->1547647564]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "This can be compared to the table for the scalar channel in appendix B of \
",
 ButtonBox["http://arxiv.org/abs/hep-th/0506184",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://arxiv.org/abs/hep-th/0506184"], None}],
 "."
}], "Text",
 CellID->1730677545]
}, Open  ]],

Cell[CellGroupData[{

Cell["RELATED TUTORIALS", "RelatedTutorialsSection",
 WholeCellGroupOpener->True,
 CellID->415694126],

Cell[TextData[ButtonBox["Introduction",
 BaseStyle->"Link",
 ButtonData->"paclet:QNMspectral/tutorial/Introduction"]], "RelatedTutorials",\

 CellID->731816627],

Cell[TextData[{
 ButtonBox["Extensions",
  BaseStyle->"Link",
  ButtonData->"paclet:QNMspectral/tutorial/Extensions"],
 " "
}], "RelatedTutorials",
 CellID->806871991],

Cell[TextData[ButtonBox["Method",
 BaseStyle->"Link",
 ButtonData->"paclet:QNMspectral/tutorial/Method"]], "RelatedTutorials",
 CellID->145118313]
}, Open  ]]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"A simple example: a massless scalar in AdS_5 - Wolfram \
Mathematica",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "TutorialColor", 
  "LinkTrails" -> GridBox[{{
      RowBox[{
        ButtonBox[
        "Mathematica", ButtonData -> "paclet:QNMspectral/guide/QNMspectral", 
         BaseStyle -> {"Link", "DockedLinkTrail"}], 
        Cell[">", "DockedLinkTrailSeparator"]}]}}, ColumnAlignments -> Left], 
  "Metadata" -> {
   "built" -> "{2016, 10, 11, 12, 16, 33.337446}", 
    "history" -> {"0.0", "", "", ""}, "context" -> "QNMspectral`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Q N Mspectral Tutorial", "language" -> "en", "paclet" -> "QNMspectral", 
    "status" -> "None", "summary" -> 
    "A technically simple example of a quasinormal mode that can only be \
computed numerically is that of a massless scalar field in an AdS_5 \
background. We will illustrate the workings of this package by computing \
these modes. This loads the package:", "synonyms" -> {}, "title" -> 
    "A simple example: a massless scalar in AdS_5", "titlemodifier" -> "", 
    "windowtitle" -> "A simple example: a massless scalar in AdS_5", "type" -> 
    "Tutorial", "uri" -> "QNMspectral/tutorial/SimpleExample"}, 
  "SearchTextTranslated" -> ""},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> 
  "9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, 2013)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[637, 21, 3227, 71, 70, "AnchorBarGrid",
 CellID->1],
Cell[CellGroupData[{
Cell[3889, 96, 179, 6, 70, "Title",
 CellID->31199131],
Cell[4071, 104, 263, 7, 70, "Text",
 CellID->1787845352],
Cell[4337, 113, 118, 3, 70, "Text",
 CellID->1556227079],
Cell[CellGroupData[{
Cell[4480, 120, 67, 1, 70, "MathCaption",
 CellID->1825449234],
Cell[4550, 123, 121, 3, 70, "Input",
 CellID->1373894796]
}, Open  ]],
Cell[CellGroupData[{
Cell[4708, 131, 71, 1, 70, "Subsection",
 CellID->937227206],
Cell[4782, 134, 530, 19, 70, "Text",
 CellID->835551855],
Cell[5315, 155, 355, 6, 70, "Text",
 CellID->1290761750],
Cell[5673, 163, 242, 5, 70, "Text",
 CellID->328755023],
Cell[5918, 170, 331, 10, 70, "Text",
 CellID->2025035829],
Cell[6252, 182, 832, 31, 70, "Text",
 CellID->1841087170],
Cell[7087, 215, 430, 14, 70, "Text",
 CellID->1765745690],
Cell[7520, 231, 907, 34, 70, "Text",
 CellID->304380513],
Cell[8430, 267, 93, 3, 70, "Text",
 CellID->429781387],
Cell[8526, 272, 611, 18, 70, "Text",
 CellID->507870360],
Cell[9140, 292, 62, 1, 70, "Text",
 CellID->1797864630],
Cell[9205, 295, 425, 17, 70, "Text",
 CellID->1741677878],
Cell[CellGroupData[{
Cell[9655, 316, 131, 6, 70, "Text",
 CellID->1060434079],
Cell[CellGroupData[{
Cell[9811, 326, 3784, 122, 70, "Input",
 CellID->1514484602],
Cell[13598, 450, 1757, 56, 70, "Output",
 CellID->549042564]
}, Open  ]]
}, Open  ]],
Cell[15382, 510, 535, 19, 70, "Text",
 CellID->1303284516],
Cell[CellGroupData[{
Cell[15942, 533, 74, 1, 70, "Text",
 CellID->1493324862],
Cell[CellGroupData[{
Cell[16041, 538, 580, 20, 70, "Input",
 InitializationCell->False,
 CellID->165628634],
Cell[16624, 560, 1083, 35, 70, "Output",
 CellID->998607368]
}, Open  ]]
}, Open  ]],
Cell[17734, 599, 366, 8, 70, "Text",
 CellID->1253768039],
Cell[18103, 609, 444, 15, 70, "Text",
 CellID->1014163764],
Cell[CellGroupData[{
Cell[18572, 628, 475, 17, 70, "Text",
 CellID->937825228],
Cell[CellGroupData[{
Cell[19072, 649, 614, 21, 70, "Input",
 InitializationCell->False,
 CellID->77585105],
Cell[19689, 672, 295, 11, 70, "Output",
 CellID->880873844],
Cell[19987, 685, 314, 11, 70, "Output",
 CellID->94433690]
}, Open  ]]
}, Open  ]],
Cell[20328, 700, 375, 9, 70, "Text",
 CellID->560623119],
Cell[20706, 711, 255, 8, 70, "Text",
 CellID->152469139],
Cell[CellGroupData[{
Cell[20986, 723, 176, 4, 70, "Text",
 CellID->2095175303],
Cell[CellGroupData[{
Cell[21187, 731, 585, 20, 70, "Input",
 InitializationCell->False,
 CellID->775987710],
Cell[21775, 753, 1133, 36, 70, "Output",
 CellID->1522130904]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22957, 795, 184, 4, 70, "Text",
 CellID->1813055722],
Cell[CellGroupData[{
Cell[23166, 803, 786, 26, 70, "Input",
 InitializationCell->False,
 CellID->697829433],
Cell[23955, 831, 551, 18, 70, "Output",
 CellID->808566492],
Cell[24509, 851, 256, 9, 70, "Output",
 CellID->300512828],
Cell[24768, 862, 337, 12, 70, "Output",
 CellID->1985046099]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25166, 881, 60, 1, 70, "Subsection",
 CellID->581645126],
Cell[25229, 884, 214, 5, 70, "Text",
 CellID->1011084164],
Cell[25446, 891, 334, 13, 70, "Text",
 CellID->1010120377],
Cell[25783, 906, 771, 27, 70, "DefinitionBox",
 CellID->1578453305],
Cell[CellGroupData[{
Cell[26579, 937, 66, 1, 70, "Text",
 CellID->729592064],
Cell[CellGroupData[{
Cell[26670, 942, 345, 12, 70, "Input",
 CellID->1694197072],
Cell[27018, 956, 271, 9, 70, "Output",
 CellID->387574357]
}, Open  ]]
}, Open  ]],
Cell[27316, 969, 134, 4, 70, "Text",
 CellID->344331292],
Cell[27453, 975, 292, 6, 70, "Text",
 CellID->1376479922]
}, Open  ]],
Cell[CellGroupData[{
Cell[27782, 986, 61, 1, 70, "Subsection",
 CellID->1658998297],
Cell[27846, 989, 89, 1, 70, "Text",
 CellID->2011042926],
Cell[27938, 992, 852, 26, 70, "DefinitionBox",
 CellID->4950932],
Cell[CellGroupData[{
Cell[28815, 1022, 56, 1, 70, "Text",
 CellID->295912815],
Cell[CellGroupData[{
Cell[28896, 1027, 117, 3, 70, "Input",
 CellID->1137110983],
Cell[29016, 1032, 1730, 39, 70, "Output",
 CellID->1419035462]
}, Open  ]]
}, Open  ]],
Cell[30773, 1075, 386, 7, 70, "Text",
 CellID->1975071336],
Cell[CellGroupData[{
Cell[31184, 1086, 90, 1, 70, "Text",
 CellID->766681643],
Cell[CellGroupData[{
Cell[31299, 1091, 169, 5, 70, "Input",
 CellID->1694873568],
Cell[31471, 1098, 1697, 42, 70, "Output",
 CellID->196057643]
}, Open  ]]
}, Open  ]],
Cell[33195, 1144, 412, 7, 70, "Text",
 CellID->730031461]
}, Open  ]],
Cell[CellGroupData[{
Cell[33644, 1156, 67, 1, 70, "Subsection",
 CellID->1118107951],
Cell[CellGroupData[{
Cell[33736, 1161, 343, 6, 70, "Text",
 CellID->1258997364],
Cell[CellGroupData[{
Cell[34104, 1171, 448, 14, 70, "Input",
 CellID->1803307368],
Cell[34555, 1187, 275, 9, 70, "Output",
 CellID->1775003733],
Cell[34833, 1198, 2652, 60, 70, "Output",
 CellID->1792400054]
}, Open  ]]
}, Open  ]],
Cell[37512, 1262, 119, 3, 70, "Text",
 CellID->818447496]
}, Open  ]],
Cell[CellGroupData[{
Cell[37668, 1270, 76, 1, 70, "Subsection",
 CellID->1211574677],
Cell[37747, 1273, 223, 5, 70, "Text",
 CellID->1859462476],
Cell[37973, 1280, 735, 25, 70, "DefinitionBox",
 CellID->1964514107],
Cell[38711, 1307, 982, 30, 70, "Text",
 CellID->1178234338],
Cell[39696, 1339, 311, 6, 70, "Text",
 CellID->1500892470],
Cell[CellGroupData[{
Cell[40032, 1349, 55, 1, 70, "Text",
 CellID->1611005974],
Cell[40090, 1352, 327, 10, 70, "Input",
 CellID->295815638]
}, Open  ]],
Cell[40432, 1365, 477, 12, 70, "Text",
 CellID->292143153],
Cell[CellGroupData[{
Cell[40934, 1381, 144, 4, 70, "Text",
 CellID->425918072],
Cell[CellGroupData[{
Cell[41103, 1389, 90, 2, 70, "Input",
 CellID->348785061],
Cell[41196, 1393, 3450, 80, 70, "Output",
 CellID->1547647564]
}, Open  ]]
}, Open  ]],
Cell[44673, 1477, 282, 9, 70, "Text",
 CellID->1730677545]
}, Open  ]],
Cell[CellGroupData[{
Cell[44992, 1491, 101, 2, 70, "RelatedTutorialsSection",
 CellID->415694126],
Cell[45096, 1495, 160, 4, 70, "RelatedTutorials",
 CellID->731816627],
Cell[45259, 1501, 167, 6, 70, "RelatedTutorials",
 CellID->806871991],
Cell[45429, 1509, 146, 3, 70, "RelatedTutorials",
 CellID->145118313]
}, Open  ]]
}, Open  ]],
Cell[45602, 1516, 23, 0, 70, "FooterCell"]
}
]
*)

(* End of internal cache information *)
